<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<!--
	========================================================================
	EXCLUSIVE ON themeforest.net
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	Template Name   : Ryan
	Author          : mital_04
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	Copyright (c) 2018 - mital_04
	========================================================================
	-->
	<!-- PAGE TITLE -->
	<title>Jim Fischer</title>
	<!-- / -->

	<!-- FONT ICON -->
	<link href="static/plugin/font-awesome/css/fontawesome-all.min.css" rel="stylesheet">
	<link href="static/plugin/themify-icons/themify-icons.css" rel="stylesheet">
	<!-- / -->

	<!-- PLUGIN CSS -->
	<link href="static/plugin/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<link href="static/plugin/owl-carousel/css/owl.carousel.min.css" rel="stylesheet">
	<link href="static/plugin/magnific/magnific-popup.css" rel="stylesheet">
	<!-- / -->

	<!-- THEME STYLE -->
	<link href="static/css/styles.css" rel="stylesheet">
	<link href="static/css/color/color-1.css" rel="stylesheet" id="color_theme">
	<!-- / -->

	<!-- FAVICON -->
	<link rel="icon" href="favicon.ico" />
	<!-- / -->
</head>

<!-- BODY -->

<body data-spy="scroll" data-target="#navbarRyan" data-offset="98">

	<!-- LOADING -->
	<div id="loading">
		<div class="load-circle"><span class="one"></span></div>
	</div>

	<!-- HEADER -->
	<header>
		<nav class="navbar header-nav header-nav fixed-top navbar-expand-lg">
			<div class="container">

				<!-- BRAND -->
				<a class="navbar-brand" href="index.html">Jim <span class="theme-bg"></span></a>

				<!-- MOBILE TOGGLE -->
				<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarRyan"
					aria-controls="navbarRyan" aria-expanded="false" aria-label="Toggle navigation">
					<span></span>
					<span></span>
					<span></span>
				</button>

				<!-- TOP MENU -->
				<div class="collapse navbar-collapse justify-content-end" id="navbarRyan">
					<ul class="navbar-nav">
						<li><a class="nav-link" href="index.html#home">Home</a></li>
						<li><a class="nav-link" href="index.html#aboutus">About</a></li>
						<li><a class="nav-link" href="index.html#portfolio">Projects</a></li>
						<li><a class="nav-link" href="index.html#contact">Contact</a></li>
					</ul>
				</div>

			</div><!-- /.END CONTAINER -->
		</nav>
	</header>
	<!-- /.END HEADER -->


	<!-- MAIN -->
	<main>

		<!-- PAGE HEADER -->
		<section class="page-title" style="background-color: #212A31;"></section>


		<section class="section blog-lising">
			<div class="container">
				<div class="row">
					<div class="col-12 col-md-12 col-lg-9 p-50px-r md-p-5px-r">
						<nav aria-label="breadcrumb">
							<ol class="breadcrumb">
								<li class="breadcrumb-item">
									<a href="index.html#portfolio">
										<i class="fa fa-chevron-left"></i>
										All Projects
									</a>
								</li>
							</ol>
						</nav>
					</div>
				</div>
				<div class="row">

					<!-- CONTENT AREA -->
					<div class="col-12 col-md-12 col-lg-9 p-50px-r md-p-15px-r">

						<!-- <a href="index.html#portfolio" class="btn btn-light btn-sm active" role="button"
								aria-pressed="true">&laquo; All Projects</a> -->

						<div class="bog-content-area mb-5">
							<h1 class="mt-5">Dynamic ETL Pipeline for Time-Series Data Across Multiple Databases</h1>
							<h4 class="mt-5">Manual. Brittle. Repetitive.</h4>
							<p class="mt-4">
								That’s the reality in many enterprise reporting environments, especially when
								time-partitioned data lives
								across dozens of identically structured databases (monthly archives, regional splits,
								regulatory snapshots).
								Too often, analysts and engineers burn time rewriting the same query over and over
								instead of delivering
								insights.
							</p>
							<p class="mt-4">
								I built this project to eliminate that friction and showcase how leadership in analytics
								is about more than
								just code. It is about designing systems that scale, removing operational waste, and
								empowering teams to
								focus on decision-making, not data wrangling.
							</p>
							<p class="mt-4">
								This Python-based ETL pipeline:
							</p>
							<ul class="mt-3">
								<li class="pb-2">
									Automatically discovers relevant databases and tables
								</li>
								<li class="pb-2">
									Dynamically constructs a <code>UNION ALL</code> SQL query across them
								</li>
								<li class="pb-2">
									Loads the result into a single consolidated dataset
								</li>
								<li>
									Writes data to a target SQL Server with batched inserts and real-time progress
									tracking
								</li>
							</ul>


							<h4 class="mt-5">Why This Matters</h4>
							<p class="mt-4">
								Siloed data doesn't just slow reporting. It delays business decisions, increases
								compliance risk, and frustrates teams. This project demonstrates how to design data
								workflows that remain flexible and adaptable when change is certain, protecting against
								schema sprawl and fragmented reporting environments.
							</p>
							<p class="mt-4">
								<b>Applicable To</b>:
							</p>
							<ul class="mt-3">
								<li class="pb-2">
									BI teams consolidating regional or monthly reporting
								</li>
								<li class="pb-2">
									Fintechs managing ledger snapshots or regulatory extracts
								</li>
								<li>
									Any business tired of “copy-paste query fatigue”
								</li>
							</ul>

							<p class="mt-4">
								While the code runs in Python, the real impact is in the architecture. Parameterized
								logic, dynamic discovery, and monitoring utilities make the process resilient,
								transparent, and scalable to hundreds of sources.
							</p>

							<blockquote class="blockquote-left mt-5">
								<div class="row">
									<div class="col-md-12">
										<h4 class="mb-3">What's inside this project</h4>
									</div>
								</div>
								<div class="row">
									<div class="col-md-6">
										<a href="#part1">Part 1: DB &amp; Table Discovery</a><br>
										Finds all qualifying databases and matching tables using naming
										patterns.<br><br>
										<a href="#part2">Part 2: Dynamic SQL Generation</a><br>
										Builds a single reusable SQL query across all sources.<br><br>
									</div>
									<div class="col-md-6">
										<a href="#part3">Part 3: Data Extraction &amp; Monitoring</a><br>
										Pulls results into a DataFrame with real-time execution monitoring.<br><br>
										<a href="#part4">Part 4: Batch Insert &amp; Load Validation</a><br>
										Inserts into target DB in batches with progress tracking and error recovery.
									</div>
								</div>
							</blockquote>


							<!-- PART 1: DB AND TABLE DISCOVERY ----------------->
							<h4 class="mt-5" id="part1">Part 1: DB &amp; Table Discovery</h4>
							<p class="mt-4">
								Instead of relying on hardcoded names, this step uses naming patterns and safe parsing
								logic to identify exactly which databases and tables to pull from. This is a
								foundational step that prevents failures down the line.
							</p>
							<p class="mt-4">
								By raising an exception when no databases match the criteria, the pipeline fails fast,
								saving hours of troubleshooting later.
							</p>

							<div class="code-container">
								<pre><code>min_year = 2015
db_prefix = 'archive_20'

query_dbs = f"""
    SELECT name FROM sys.databases
    WHERE name LIKE '{db_prefix}%'
      AND TRY_CAST(REPLACE(name, '{db_prefix}', '') AS INT) &gt; {min_year}
"""

dbs = pd.read_sql(query_dbs, engine_src)['name'].tolist()

if not dbs:
    raise ValueError(f"No databases found with prefix '{db_prefix}' after {min_year}.")
</code></pre>
							</div>




							<!-- <p class="pt-4">
								<b>Discover Tables in Each Database</b>
							</p> -->
							<p class="pt-0">
								Once databases are identified, the pipeline inspects each to find tables that match a
								known pattern. This creates a fully qualified list of tables that will feed the dynamic
								SQL in the next step, ensuring no guesswork or manual maintenance.
							</p>
							<div class="code-container">
								<pre><code>table_name_pattern = 'archive_data_%'
table_refs = []

for db in dbs:
    query_tables = f"""
        SELECT '{db}' AS dbname, TABLE_NAME
        FROM [{db}].INFORMATION_SCHEMA.TABLES
        WHERE TABLE_NAME LIKE '{table_name_pattern}'
    """
    tables = pd.read_sql(query_tables, engine_src)

    if tables.empty:
        print(f"No matching tables found in {db}")
        continue

    for _, row in tables.iterrows():
        table_refs.append(f"[{db}].[dbo].[{row['TABLE_NAME']}]")
</code></pre>
							</div>


							<p class="pt-4">
								This approach allows the ETL process to instantly adapt when new partitions are added or
								old ones are retired, without rewriting any SQL.
							</p>


							<hr class="mt-5">

							<!-- PART 2: DYNAMIC SQL GENERATION ----------------->
							<h4 class="mt-5" id="part2">Part 2: Dynamic SQL Generation</h4>
							<p class="mt-4">
								The next challenge is pulling from every matching table without manually writing a
								separate <code>SELECT</code> for each.
							</p>

							<p class="mt-4">
								By parameterizing the columns and filters, this query can serve multiple business needs
								such as regulatory extracts or ad-hoc reporting.
							</p>

							<div class="code-container">
								<pre><code>columns = 'column1, column2, column3'
where_clause = 'WHERE your_date_column &gt;= DATEADD(MONTH, -6, GETDATE())'

union_queries = [f"SELECT {columns} FROM {tbl} {where_clause}" for tbl in table_refs]
final_query = ' UNION ALL\n'.join(union_queries)

full_query = f"""
    WITH CombinedData AS (
        {final_query}
    )
    SELECT * FROM CombinedData
"""
</code></pre>
							</div>

							<p class="mt-4">
								This is the difference between building a script and designing a framework. The moment a
								new table appears in the source environment, this pipeline adapts without developer
								intervention.
							</p>

							<hr class="mt-5">

							<!-- PART 3: DATA EXTRACTION AND MONITORING --------->
							<h4 class="mt-5" id="part3">Part 3: Data Extraction &amp; Monitoring</h4>
							<p class="mt-4">
								Long-running queries can be black boxes. This pipeline includes lightweight,
								non-blocking stopwatch utilities to give real-time visibility. A small touch like this
								can dramatically improve developer and stakeholder confidence.
							</p>

							<div class="code-container">
								<pre><code>try:
    df = pd.read_sql(full_query, engine_src)
except Exception as e:
    stop_event.set()
    thread.join()
    raise RuntimeError(f"Query failed: {e}")
finally:
    stop_event.set()
    thread.join()

print(f"Loaded {len(df):,} rows.")
</code></pre>
							</div>

							<div class="code-container">
								<pre><code>def simple_stopwatch(stop_event):
    start = time.time()
    while not stop_event.is_set():
        elapsed = time.time() - start
        print(f"\rElapsed time: {int(elapsed // 60)}m {int(elapsed % 60)}s", end='')
        time.sleep(1)
    print()
</code></pre>
							</div>

							<p class="mt-4">
								By showing progress live, you make ETL
								runs predictable, reduce unnecessary interruptions, and enable concurrent work. This
								directly multiplies team output.
							</p>

							<hr class="mt-5">

							<!-- PART 4: DATA EXTRACTION AND MONITORING --------->
							<h4 class="mt-5" id="part4">Part 4: Batch Insert &amp; Load Validation</h4>
							<p class="mt-4">
								Loading millions of rows in one go is risky. This pipeline uses 10,000-row batches with
								row count tracking and batch-level error handling for resilience.
							</p>

							<div class="code-container">
								<pre><code>for i in range(0, len(df), batch_size):
    batch = df.iloc[i:i+batch_size]
    mode = 'replace' if i == 0 else 'append'
    try:
        batch.to_sql('TargetTable', engine_target, if_exists = mode, index = False, schema = 'dbo')
        rows_loaded[0] += len(batch)
    except Exception as e:
        print(f"\nError inserting batch {i//batch_size + 1}: {e}")
</code></pre>
							</div>

							<p class="mt-4">
								This method ensures that even if one batch fails, the rest of the load proceeds. In
								production environments with tight nightly load windows, partial success is better than
								total failure.
							</p>


							<hr class="mt-5">


							<!-- FINAL TAKEAWAYS -------------------------------->
							<h4 class="mt-5" id="part4">Final Takeaway</h4>
							<p class="mt-4">
								This project is a blueprint for scalable reporting automation. It embodies the
								principles I apply when building analytics solutions that deliver lasting business
								value:
							</p>
							<ul class="mt-3">
								<li class="pb-2">
									Remove waste through automation
								</li>
								<li class="pb-2">
									Increase resilience with error handling and monitoring
								</li>
								<li>
									Design for scale so solutions adapt with the business
								</li>
							</ul>
							<p class="mt-4">
								Whether it is 20 databases or 200, the framework remains the same: discover, unify,
								monitor, and deliver without downtime or manual intervention.
							</p>


							<hr class="mt-5">

							
							<p class="mt-3">
								Want to see how raw engagement data can be transformed into strategic insights?  
							</p>
							<a href="churn-predicition.html" class="btn btn-custom btn-sm mt-3" role="button"
								aria-pressed="true">
								Explore My Fitness Studio Membership Churn Prediction Project
								<i class="fa fa-chevron-right"></i>
							</a>
						</div>
					</div>
					<!-- /.END CONTENT AREA -->


					<!-- SIDE BAR -->
					<div class="col-12 col-md-12 col-lg-3 md-m-30px-b mt-5">

						<div class="sidebar-widget">
							<h5 class="widget-title font-alt">SECTIONS</h5>
							<div class="widget-categories">
								<ul class="list-style-1">
									<li><a href="churn-predicition-p1-etl.html">Part 1: DB &amp; Table Discovery</a>
									</li>
									<li><a href="churn-predicition-p2-eda.html">Part 2: Dynamic SQL Generation</a></li>
									<li><a href="churn-predicition-p3-models.html">Part 3: Data Extraction &amp;
											Monitoring</a></li>
									<li><a href="churn-predicition-p4-strategic-rec.html">Part 4: Batch Insert &amp;
											Load Validation</a></li>
								</ul>
							</div>
						</div>

						<div class="sidebar-widget">
							<h5 class="widget-title font-alt">GITHUB REPO</h5>
							<div class="widget-categories">
								<ul class="list-style-1">
									<li><a href="#" target="_blank"><i
												class="fab fa-github-alt"></i> Dynamic ETL Pipeline</a></li>

								</ul>
							</div>
						</div>

						<div class="sidebar-widget">
							<h5 class="widget-title font-alt">TECH STACK</h5>
							<div class="widget-popular-tag">
								<ul class="list-style-tag">
									<li><a href="">Python</a></li>
									<li><a href="">Pandas</a></li>
									<li><a href="">SQLAlchemy</a></li>
									<li><a href="">SQL Server</a></li>
									<li><a href="">pyodbc</a></li>
									<li><a href="">Jupyter</a></li>
									<li><a href="">GitHub</a></li>
								</ul>
							</div>
						</div>

						<div class="sidebar-widget">
							<h5 class="widget-title font-alt">FOCUS AREAS</h5>
							<div class="widget-popular-tag">
								<ul class="list-style-tag">
									<li><a href="">ETL Pipeline Design</a></li>
									<li><a href="">Data Ingestion</a></li>
									<li><a href="">Batch Processing</a></li>
									<li><a href="">Optimization</a></li>
									<li><a href="">Error Handling</a></li>
									<li><a href="">Logging</a></li>
									<li><a href="">Data Quality &amp; Validation</a></li>
									<li><a href="">Performance Multi-Threading</a></li>
									<li><a href="">Pipeline Monitoring</a></li>
								</ul>
							</div>
						</div>

					</div>
					<!-- /.END SIDE BAR -->

				</div> <!-- /.END ROW -->
			</div> <!-- /.END CONTAINER -->
		</section>

	</main>
	<!-- /.END MAIN -->

	<!-- FOOTER -->
	<footer class="footer footer-blog">
		<div class="container">
			<div class="footer-logo">
				<span>Jim Fischer <span class="theme-bg"></span></span>
			</div>
			<ul class="social-icons">
				<li><a href="https://github.com/JF-30000?tab=repositories" target="_blank"><i
							class="fab fa-github-alt"></i></a></li>
				<li><a href="https://www.linkedin.com/in/jamesafischer" target="_blank"><i
							class="fab fa-linkedin-in"></i></a></li>
			</ul>
		</div>
	</footer>

	<!-- JQUERY -->
	<script src="static/js/jquery-3.2.1.min.js"></script>
	<script src="static/js/jquery-migrate-3.0.0.min.js"></script>

	<!-- PLUGINS -->
	<script src="static/plugin/bootstrap/js/popper.min.js"></script>
	<script src="static/plugin/bootstrap/js/bootstrap.min.js"></script>
	<script src="static/plugin/owl-carousel/js/owl.carousel.min.js"></script>
	<script src="static/plugin/isotope/isotope.pkgd.min.js"></script>
	<script src="static/plugin/magnific/jquery.magnific-popup.min.js"></script>
	<!-- custom -->
	<script src="static/js/custom.js"></script>

</body>
<!-- ./END BODY -->

</html>